
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>SuDoKu</title>
	<link rel="stylesheet" href="/static/css/bootstrap.css">
	<link rel="stylesheet" href="/static/css/estilos.css">
</head>

<body id="contenedor">
	<header>
	<div class="row" >
		<div class="col-xs-12 col-md-6">
			<hgroup>
				<h1>SUDOKU</h1>
				<h2>Registrate para guardar tu puntuación!</h2>
			</hgroup>
			 
		</div>


		<div class="col-xs-12 col-md-6">	
			<br>
			<form action="" method="POST" role="form" class="form-inline" >
				<label for="">Email:</label>
				<input id="email" name="email" type="email" class="form-control"  required>
				<label for="">Password:</label>
				<input id="password" name="password" type="password" class="form-control"  required>
				<button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-log-in" ></span> Sign in</button>
			</form>
		</div>
	</div>
	</header>

<section>
	<article id="contenido">
	<p>El Sudoku es un rompecabezas de lógica y uno de los pasatiempos que más contagia.</p>
	<p>El objetivo es rellenar una cuadrícula de 9×9 celdas dividida en subcuadrículas de 3×3 con las cifras del 1 al 9 partiendo de algunos números ya dispuestos en algunas de las celdas.</p>
	<p>No se debe repetir ningún número en una misma fila, columna o subcuadrícula.</p>
	<p>Al principio, para animarse, en vez de comenzar el proceso por la primera casilla (arriba a la izquierda) hasta la última (abajo a la derecha), podemos hacerlo por la caja o fila que tenga más números fijos. De esta forma, pronto tendremos una fila, columna o caja completa y nos proporcionará aliento para seguir jugando. Una vez resuelto el puzzle, presione el botón de validar, y su puntuacion quedará registrado junto a su nombre.</p>
	<p id="p">VAMOS! Entra, registrate y diviertete mientras aprendes y desarrollas tu mente.</p>
	</article>

		<figure id="sudoku">
			<h2>SUDOKU</h2>
				<ul>
					<li><strong>Nivel de dificultad:</strong><a href="#" class="btn btn-success">	Facil</a><a href="#"class="btn btn-success">	Intermedio</a><a href="#" class="btn btn-success">	Dificil</a></li>
				</ul>



<div id="div-board" class="div-board">
<center>
	<table id="table0" class="table-main" cellspacing="0" cellpadding="0">
		<tr>
		<td>
			<table id="table1" class="table-region" cellspacing="0" cellpadding="0">
				<tr>
				<td><input id="c0" class="cell" type="text" size="	" maxlength="1"></td>
				<td><input id="c1" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c2" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c9" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c10" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c11" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c18" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c19" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c20" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
			</table>
		</td>
		<td>
			<table id="table2" class="table-region" cellspacing="0" cellpadding="0">
				<tr>
				<td><input id="c3" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c4" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c5" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c12" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c13" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c14" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c21" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c22" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c23" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
			</table>
		</td>

		<td>
			<table id="table3" class="table-region" cellspacing="0" cellpadding="0">
				<tr>
				<td><input id="c6" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c7" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c8" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c15" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c16" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c17" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c24" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c25" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c26" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
			</table>
		</td>
		</tr>

		<tr>
		<td>
			<table id="table4" class="table-region" cellspacing="0" cellpadding="0">
				<tr>
				<td><input id="c27" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c28" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c29" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c36" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c37" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c38" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c45" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c46" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c47" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
			</table>
		</td>

		<td>
			<table id="table5" class="table-region" cellspacing="0" cellpadding="0">
				<tr>
				<td><input id="c30" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c31" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c32" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c39" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c40" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c41" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c48" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c49" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c50" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
			</table>
		</td>

		<td>
			<table id="table6" class="table-region" cellspacing="0" cellpadding="0">
				<tr>
				<td><input id="c33" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c34" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c35" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c42" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c43" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c44" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c51" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c52" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c53" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
			</table>
		</td>	
		</tr>

		<tr>
		<td>
			<table id="table7" class="table-region" cellspacing="0" cellpadding="0">
				<tr>
				<td><input id="c54" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c55" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c56" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c63" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c64" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c65" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c72" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c73" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c74" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
			</table>
		</td>

		<td>
			<table id="table8" class="table-region" cellspacing="0" cellpadding="0">
				<tr>	
				<td><input id="c57" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c58" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c59" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c66" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c67" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c68" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c75" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c76" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c77" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
			</table>
		</td>
			
		<td>
			<table id="table9" class="table-region" cellspacing="0" cellpadding="0">
				<tr>
				<td><input id="c60" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c61" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c62" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c69" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c70" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c71" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
				<tr>
				<td><input id="c78" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c79" class="cell" type="text" size="1" maxlength="1"></td>
				<td><input id="c80" class="cell" type="text" size="1" maxlength="1"></td>
				</tr>
			</table>
		</td>
		</tr>

	</table>

<input id="bn-validate" type="button" class="bn-validate" onClick="game.validate()" value="Validar!" name="bn-validate"/>

</center>
</div>
			
		</figure>
</section>

<nav>
	<ul>
		<li><a href="{%url "home"%}">Nuevo Juego</a></li>
		<li><a href="#">Reiniciar Juego</a></li>
		<li><a href="#">Resolver Juego</a></li>
	</ul>
</nav>






<script type="text/javascript">

//
// Game
//
function Game() {
  this.board = new Board();

  this.run = function() {
    this.board.start();
  }
  
  this.validate = function() {
    this.board.validate();
  }
}

//
// Board
//
function Board() {
  this.grid   = new Grid();
  this.sudoku = new Array();

  this.start = function() {
    this.generateSudoku();
    this.showTips();
  }

  this.generateSudoku = function() {
    this.initSudoku();
    this.generateCell(0);
  }

  this.initSudoku = function() {
    for (var row = 0; row < this.grid.rows; ++ row)
      this.sudoku[row] = new Array(this.grid.cols);
  }

  this.generateCell = function(id) {
    if (id == this.grid.rows * this.grid.cols) 
      return(true);
    
    var row  = Math.floor(id / this.grid.rows);
    var col  = id - (row * this.grid.rows)
    var suit = this.shuffle(this.grid.suit);
    
    for (var index in suit) {
      this.sudoku[row][col] = suit[index];

      if ( this.isValidCell(row, col) )
        if ( this.generateCell(id + 1) )
          return(true);
    }

    this.sudoku[row][col] = null;
    return(false);
  }

  this.isValidCell = function(row, col) {
    return( this.isValidRow(row, col) &&
            this.isValidColumn(row, col) &&
            this.isValidRegion(row, col) );
  }

  this.isValidRow = function(row, col) {
    var count = new Array();
    for (var c = 0; c <= col; ++ c) {
      if (count[ this.sudoku[row][c] ] != null)
        return(false);
      count[ this.sudoku[row][c] ] = 1;
    }
    return(true);
  }

  this.isValidColumn = function(row, col) {
    var count = new Array();
    for (var r = 0; r <= row; ++ r) {
      if (count[ this.sudoku[r][col] ] != null)
        return(false);
      count[ this.sudoku[r][col] ] = 1;
    }
    return(true);
  }
  
  this.isValidRegion = function(row, col) {
    var count = new Array();
    var rowi  = this.grid.region * Math.floor(row / this.grid.region);
    var coli  = this.grid.region * Math.floor(col / this.grid.region);

    for (var r = rowi; r <= row; ++ r)
      for (var c = coli; c <= col; ++ c) {
        if ( count[ this.sudoku[r][c] ] != null)
          return(false);
        count[ this.sudoku[r][c] ] = 1;
      }

    return(true);
  }

  this.showTips = function() {
    var spans = this.shuffle(this.grid.spans);
    for (var row = 0; row < this.grid.rows; ++ row) {
      var tips = this.shuffle(this.grid.tips);
      for (var col = 0; col < spans[row]; ++ col)
        this.grid.setCellValue(row, tips[col], this.sudoku[row][ tips[col] ]);
    }
  }

  this.validate = function() {
    if ( this.isValidSudoku() )
      alert("FELICITACIONES!!! Has logrado solventar el SuDoKu.");
    else
      alert("Lo siento, esta no es un respuesta valida para el SuDoKu.");
  }

  this.isValidSudoku = function() {
    var cells = this.grid.getCellValues();

    var valid = true;
    for (var row in this.sudoku)
      for (var col in this.sudoku[row])
        if (cells[row][col] != this.sudoku[row][col]) {
          valid = false;
          break;
        }
        
    return(valid);
  }

  this.shuffle = function(suit) {
    for (var i in suit)
      suit = swap(suit, i, Math.floor( Math.random() * suit.length ) );
    return(suit);
  }
}

//
// Grid
//
function Grid() {
  this.rows   = 9;
  this.cols   = 9;
  this.region = 3;
  this.spans  = new Array(4, 4, 4, 3, 3, 3, 2, 2, 2);
  this.tips   = new Array(0, 1, 2, 3, 4, 5, 6, 7, 8);
  this.suit   = new Array(1, 2, 3, 4, 5, 6, 7, 8, 9);

  this.getCellId = function(row, col) {
    return("c" + String( (row * this.rows) + col) );
  }

  this.getCell = function(id) {
    return( document.getElementById(id) );
  }

  this.getCellValue = function(row, col) {
    return( this.getCellValueById( this.getCellId(row, col) ) );
  }

  this.getCellValueById = function(id) {
    return( this.getCell(id).value );
  }

  this.setCellValue = function(row, col, value) {
    this.setCellValueById( this.getCellId(row, col), value);
  }
  
  this.setCellValueById = function(id, value) {
    var cell = this.getCell(id);
    cell.value     = String(value);
    cell.className = "cell-disable";
    cell.readOnly  = "readonly";
  }

  this.getCellValues = function() {
    var cells = new Array();

    for (var row = 0; row < this.rows; ++ row) {
      cells[row] = new Array();
      for (var col = 0; col < this.cols; ++ col)
        cells[row][col] = this.getCellValue(row, col);
    }

    return(cells);
  }
}

//
// Utils
//
function swap(array, i, j) {
  var temp = array[i];
  array[i] = array[j];
  array[j] = temp;

  return(array);
}

function getKeyCode(e) {
  return(e? e.keyCode: window.event.keyCode);
}

//
//
document.onkeydown = function(e){
  if( getKeyCode(e) == 116) {
     window.location.reload(true);
     return(false);
    }
}

//
//
var game = new Game;
game.run();

</script>






</body>
</html>

